\setlrmarginsandblock{3cm}{2cm}{*}
\setulmarginsandblock{3.3cm}{2.7cm}{*}

\OnehalfSpacing

\setsecnumdepth{subsection}
\settocdepth{subsection}

\setheadfoot{\baselineskip}{0pt}
\setheaderspaces{2cm}{*}{*}

\makepagestyle{thesis}

\makeevenhead{thesis}{\alt\thepage}{}{\alt\leftmark}
\makeoddhead{thesis}{\alt\rightmark}{}{\alt\thepage}
\makeheadrule{thesis}{\textwidth}{2\normalrulethickness}

\pagestyle{thesis}

\renewcommand{\chapnumfont}{\Huge\bfseries\alt}
\renewcommand{\printchaptername}{}
\renewcommand{\printchapternum}{}

\renewcommand{\printchaptertitle}[1]{
    \ifnum\value{chapter} > 0
        \begin{minipage}{3.5cm}
            \begin{tcolorbox}[
                sharp corners,
                colback = primary,
                colframe = secondary,
                boxrule = 0pt,
                rightrule = 10pt,
                width = 3.5cm,
                height = 2cm,
                valign = center,
            ]
                \fontsize{60pt}{0pt}\color{white}\alt\bfseries\thechapter
            \end{tcolorbox}
        \end{minipage}\hfill
        \raisebox{-15pt}{\huge\bfseries\alt\color{primary}#1}\\[0pt]
    \else
        \centering
        \raisebox{-15pt}{\huge\bfseries\alt\color{primary}#1}\\[0pt]
    \fi
}

\setlength{\afterchapskip}{1cm}

\setsecheadstyle{\Large\bfseries\alt}
\setsubsecheadstyle{\large\bfseries\alt}
\setsubsubsecheadstyle{\bfseries\alt}

\makeatletter
\renewcommand{\@seccntformat}[1]{
    \textcolor{primary}{\csname the#1\endcsname}\quad
}
\makeatother

\let\oldchapter\chapter
\renewcommand{\chapter}[1]{
    \oldchapter{#1}
    \thispagestyle{empty}
}

\NewTcbTheorem[number within = chapter]{defbox}{Definizione}{
    sharp corners,
    fonttitle = {\large\color{primary}\alt\fontseries{mid}\selectfont},
    sharp corners,
    colframe = primary,
    colback = white,
    boxrule = 0pt,
    leftrule = 2.5pt,
    valign = center,
    attach title to upper = {\par},
    separator sign = .,
    breakable,
    title style = {
        left = 50mm,
    }
}{def}

\NewTcbTheorem[number within = chapter]{thmbox}{Teorema}{
    sharp corners,
    fonttitle = {\large\color{primary}\alt\fontseries{mid}\selectfont},
    sharp corners,
    colframe = primary,
    colback = white,
    boxrule = 0pt,
    leftrule = 2.5pt,
    valign = center,
    attach title to upper = {\par},
    separator sign = .,
    breakable,
    title style = {
        left = 50mm,
    }
}{thm}
